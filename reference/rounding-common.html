<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Common rounding procedures — rounding-common • scrutiny</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Common rounding procedures — rounding-common"><meta name="description" content="round_up() rounds up from 5, round_down() rounds down from
5. Otherwise, both functions work like base::round().
round_up() and round_down() are special cases of round_up_from() and
round_down_from(), which allow users to choose custom thresholds for
rounding up or down, respectively."><meta property="og:description" content="round_up() rounds up from 5, round_down() rounds down from
5. Otherwise, both functions work like base::round().
round_up() and round_down() are special cases of round_up_from() and
round_down_from(), which allow users to choose custom thresholds for
rounding up or down, respectively."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scrutiny</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Consistency tests</h6></li>
    <li><a class="dropdown-item" href="../articles/grim.html">GRIM</a></li>
    <li><a class="dropdown-item" href="../articles/grimmer.html">GRIMMER</a></li>
    <li><a class="dropdown-item" href="../articles/debit.html">DEBIT</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Plausibility checks</h6></li>
    <li><a class="dropdown-item" href="../articles/duplicates.html">Duplication analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Quick guides</h6></li>
    <li><a class="dropdown-item" href="../articles/rounding-options.html">Rounding options</a></li>
    <li><a class="dropdown-item" href="../articles/consistency-tests-simple.html">Implementing your consistency test</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developer tools</h6></li>
    <li><a class="dropdown-item" href="../articles/rounding-in-depth.html">Rounding in depth</a></li>
    <li><a class="dropdown-item" href="../articles/consistency-tests-in-depth.html">Consistency tests in depth</a></li>
    <li><a class="dropdown-item" href="../articles/devtools.html">Developer tools</a></li>
    <li><a class="dropdown-item" href="../articles/wrangling.html">Data wrangling</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Other</h6></li>
    <li><a class="dropdown-item" href="../articles/related.html">Related software</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lhdjung/scrutiny/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Common rounding procedures</h1>
      <small class="dont-index">Source: <a href="https://github.com/lhdjung/scrutiny/blob/main/R/round.R" class="external-link"><code>R/round.R</code></a></small>
      <div class="d-none name"><code>rounding-common.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>round_up()</code> rounds up from 5, <code>round_down()</code> rounds down from
5. Otherwise, both functions work like <code><a href="https://rdrr.io/r/base/Round.html" class="external-link">base::round()</a></code>.</p>
<p><code>round_up()</code> and <code>round_down()</code> are special cases of <code>round_up_from()</code> and
<code>round_down_from()</code>, which allow users to choose custom thresholds for
rounding up or down, respectively.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">round_up_from</span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fl">0L</span>, <span class="va">threshold</span>, symmetric <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">round_down_from</span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fl">0L</span>, <span class="va">threshold</span>, symmetric <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">round_up</span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fl">0L</span>, symmetric <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">round_down</span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fl">0L</span>, symmetric <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Numeric. The decimal number to round.</p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>Integer. Number of digits to round <code>x</code> to. Default is <code>0</code>.</p></dd>


<dt id="arg-threshold">threshold<a class="anchor" aria-label="anchor" href="#arg-threshold"></a></dt>
<dd><p>Integer. Only in <code>round_up_from()</code> and <code>round_down_from()</code>.
Threshold for rounding up or down, respectively. Value is <code>5</code> in
<code>round_up()</code>'s internal call to <code>round_up_from()</code> and in <code>round_down()</code>'s
internal call to <code>round_down_from()</code>.</p></dd>


<dt id="arg-symmetric">symmetric<a class="anchor" aria-label="anchor" href="#arg-symmetric"></a></dt>
<dd><p>Logical. Set <code>symmetric</code> to <code>TRUE</code> if the rounding of
negative numbers should mirror that of positive numbers so that their
absolute values are equal. Default is <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Numeric. <code>x</code> rounded to <code>digits</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>These functions differ from <code><a href="https://rdrr.io/r/base/Round.html" class="external-link">base::round()</a></code> mainly insofar as the
decision about rounding 5 up or down is not based on the integer portion of
<code>x</code> (i.e., no "rounding to even"). Instead, in <code>round_up_from()</code>, that
decision is determined by the <code>threshold</code> argument for rounding up, and
likewise with <code>round_down_from()</code>. The threshold is constant at <code>5</code> for
<code>round_up()</code> and <code>round_down()</code>.</p>
<p>As a result, these functions are more predictable and less prone to
floating-point number quirks than <code><a href="https://rdrr.io/r/base/Round.html" class="external-link">base::round()</a></code>. Compare <code>round_down()</code>
and <code><a href="https://rdrr.io/r/base/Round.html" class="external-link">base::round()</a></code> in the data frame for rounding 5 created in the
Examples section below: <code>round_down()</code> yields a continuous sequence of
final digits from 0 to 9, whereas <code><a href="https://rdrr.io/r/base/Round.html" class="external-link">base::round()</a></code> behaves in a way that
can only be explained by floating point issues.</p>
<p>However, this surprising behavior on the part of <code><a href="https://rdrr.io/r/base/Round.html" class="external-link">base::round()</a></code> is not
necessarily a flaw (see its documentation, or this vignette:
https://rpubs.com/maechler/Rounding). In the present version of R (4.0.0 or
later), <code><a href="https://rdrr.io/r/base/Round.html" class="external-link">base::round()</a></code> works fine, and the functions presented here are
not meant to replace it. Their main purpose as helpers within scrutiny is
to reconstruct the computations of researchers who might have used
different software. See <code><a href="../articles/rounding-options.html">vignette("rounding-options")</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="rounding-uncommon.html">round_ceiling()</a></code> always rounds up, <code><a href="rounding-uncommon.html">round_floor()</a></code> always
rounds down, <code><a href="rounding-uncommon.html">round_trunc()</a></code> always rounds toward 0, and
<code><a href="rounding-uncommon.html">round_anti_trunc()</a></code> always round away from 0.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Both `round_up()` and `round_down()` work like</span></span></span>
<span class="r-in"><span><span class="co"># `base::round()` unless the closest digit to be</span></span></span>
<span class="r-in"><span><span class="co"># cut off by rounding is 5:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="fu">round_up</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">9.273</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>     <span class="co"># 7 cut off</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.3</span>
<span class="r-in"><span> <span class="fu">round_down</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">9.273</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>     <span class="co"># 7 cut off</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.3</span>
<span class="r-in"><span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">9.273</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>     <span class="co"># 7 cut off</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="fu">round_up</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">7.584</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>     <span class="co"># 4 cut off</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7.58</span>
<span class="r-in"><span> <span class="fu">round_down</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">7.584</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>     <span class="co"># 4 cut off</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7.58</span>
<span class="r-in"><span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">7.584</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>     <span class="co"># 4 cut off</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7.58</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Here is the borderline case of 5 rounded by</span></span></span>
<span class="r-in"><span><span class="co"># `round_up()`, `round_down()`, and `base::round()`:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">original</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>    <span class="co"># Define example values</span></span></span>
<span class="r-in"><span>  <span class="fl">0.05</span>, <span class="fl">0.15</span>, <span class="fl">0.25</span>, <span class="fl">0.35</span>, <span class="fl">0.45</span>,</span></span>
<span class="r-in"><span>  <span class="fl">0.55</span>, <span class="fl">0.65</span>, <span class="fl">0.75</span>, <span class="fl">0.85</span>, <span class="fl">0.95</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>   <span class="co"># Output table</span></span></span>
<span class="r-in"><span>  <span class="va">original</span>,</span></span>
<span class="r-in"><span>  round_up <span class="op">=</span> <span class="fu">round_up</span><span class="op">(</span>x <span class="op">=</span> <span class="va">original</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  round_down <span class="op">=</span> <span class="fu">round_down</span><span class="op">(</span>x <span class="op">=</span> <span class="va">original</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  base_round <span class="op">=</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">original</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 10 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    original round_up round_down base_round</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>     0.05      0.1        0          0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>     0.15      0.2        0.1        0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>     0.25      0.3        0.2        0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>     0.35      0.4        0.3        0.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>     0.45      0.5        0.4        0.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>     0.55      0.6        0.5        0.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>     0.65      0.7        0.6        0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>     0.75      0.8        0.7        0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>     0.85      0.9        0.8        0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>     0.95      1          0.9        0.9</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (Note: Defining `original` as `seq(0.05:0.95, by = 0.1)`</span></span></span>
<span class="r-in"><span><span class="co"># would lead to wrong results unless `original` is rounded</span></span></span>
<span class="r-in"><span><span class="co"># to 2 or so digits before it's rounded to 1.)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lukas Jung.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

