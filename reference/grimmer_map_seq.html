<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>GRIMMER-testing with dispersed inputs — grimmer_map_seq • scrutiny</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="GRIMMER-testing with dispersed inputs — grimmer_map_seq"><meta name="description" content="grimmer_map_seq() performs GRIMMER-testing with values
surrounding the input values. This provides an easy and powerful way to
assess whether small errors in computing or reporting may be responsible
for GRIMMER inconsistencies in published statistics.
Call audit_seq() on the results for summary statistics."><meta property="og:description" content="grimmer_map_seq() performs GRIMMER-testing with values
surrounding the input values. This provides an easy and powerful way to
assess whether small errors in computing or reporting may be responsible
for GRIMMER inconsistencies in published statistics.
Call audit_seq() on the results for summary statistics."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scrutiny</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Consistency tests</h6></li>
    <li><a class="dropdown-item" href="../articles/grim.html">GRIM</a></li>
    <li><a class="dropdown-item" href="../articles/grimmer.html">GRIMMER</a></li>
    <li><a class="dropdown-item" href="../articles/debit.html">DEBIT</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Plausibility checks</h6></li>
    <li><a class="dropdown-item" href="../articles/duplicates.html">Duplication analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Quick guides</h6></li>
    <li><a class="dropdown-item" href="../articles/rounding-options.html">Rounding options</a></li>
    <li><a class="dropdown-item" href="../articles/consistency-tests-simple.html">Implementing your consistency test</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developer tools</h6></li>
    <li><a class="dropdown-item" href="../articles/rounding-in-depth.html">Rounding in depth</a></li>
    <li><a class="dropdown-item" href="../articles/consistency-tests-in-depth.html">Consistency tests in depth</a></li>
    <li><a class="dropdown-item" href="../articles/devtools.html">Developer tools</a></li>
    <li><a class="dropdown-item" href="../articles/wrangling.html">Data wrangling</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Other</h6></li>
    <li><a class="dropdown-item" href="../articles/related.html">Related software</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lhdjung/scrutiny/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>GRIMMER-testing with dispersed inputs</h1>
      <small class="dont-index">Source: <a href="https://github.com/lhdjung/scrutiny/blob/main/R/grimmer-map-seq.R" class="external-link"><code>R/grimmer-map-seq.R</code></a></small>
      <div class="d-none name"><code>grimmer_map_seq.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>grimmer_map_seq()</code> performs GRIMMER-testing with values
surrounding the input values. This provides an easy and powerful way to
assess whether small errors in computing or reporting may be responsible
for GRIMMER inconsistencies in published statistics.</p>
<p>Call <code><a href="audit-special.html">audit_seq()</a></code> on the results for summary statistics.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">grimmer_map_seq</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sd <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  var <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  dispersion <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>  out_min <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  out_max <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  include_reported <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include_consistent <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame that <code><a href="grimmer_map.html">grimmer_map()</a></code> could take.</p></dd>


<dt id="arg-x-sd-n">x, sd, n<a class="anchor" aria-label="anchor" href="#arg-x-sd-n"></a></dt>
<dd><p>Optionally, specify these arguments as column names in <code>data</code>.</p></dd>


<dt id="arg-var">var<a class="anchor" aria-label="anchor" href="#arg-var"></a></dt>
<dd><p>String. Names of the columns that will be dispersed. Default is
<code>c("x", "sd", "n")</code>.</p></dd>


<dt id="arg-dispersion">dispersion<a class="anchor" aria-label="anchor" href="#arg-dispersion"></a></dt>
<dd><p>Numeric. Sequence with steps up and down from the <code>var</code>
inputs. It will be adjusted to these values' decimal levels. For example,
with a reported <code>8.34</code>, the step size is <code>0.01</code>. Default is <code>1:5</code>, for five
steps up and down.</p></dd>


<dt id="arg-out-min-out-max">out_min, out_max<a class="anchor" aria-label="anchor" href="#arg-out-min-out-max"></a></dt>
<dd><p>If specified, output will be restricted so that it's
not below <code>out_min</code> or above <code>out_max</code>. Defaults are <code>"auto"</code> for
<code>out_min</code>, i.e., a minimum of one decimal unit above zero; and <code>NULL</code> for
<code>out_max</code>, i.e., no maximum.</p></dd>


<dt id="arg-include-reported">include_reported<a class="anchor" aria-label="anchor" href="#arg-include-reported"></a></dt>
<dd><p>Logical. Should the reported values themselves be
included in the sequences originating from them? Default is <code>FALSE</code> because
this might be redundant and bias the results.</p></dd>


<dt id="arg-include-consistent">include_consistent<a class="anchor" aria-label="anchor" href="#arg-include-consistent"></a></dt>
<dd><p>Logical. Should the function also process
consistent cases (from among those reported), not just inconsistent ones?
Default is <code>FALSE</code> because the focus should be on clarifying
inconsistencies.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed down to <code><a href="grimmer_map.html">grimmer_map()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble (data frame) with detailed test results. See
<code><a href="grimmer_map.html">grimmer_map()</a></code> for an explanation of the <code>reason</code> column.</p>
    </div>
    <div class="section level2">
    <h2 id="summaries-with-audit-seq-">Summaries with <code><a href="audit-special.html">audit_seq()</a></code><a class="anchor" aria-label="anchor" href="#summaries-with-audit-seq-"></a></h2>
    <p>You can call <code><a href="audit-special.html">audit_seq()</a></code>
following <code>grimmer_map_seq()</code>. It will return a data frame with these
columns:</p><ul><li><p><code>x</code>, <code>sd</code>, and <code>n</code> are the original inputs,
tested for <code>consistency</code> here.</p></li>
<li><p><code>hits_total</code> is the total number of GRIMMER-consistent value sets
found within the specified <code>dispersion</code> range.</p></li>
<li><p><code>hits_x</code> is the number of GRIMMER-consistent value sets
found by varying <code>x</code>.</p></li>
<li><p>Accordingly with <code>sd</code> and <code>hits_sd</code> as well as <code>n</code> and <code>hits_n</code>.</p></li>
<li><p>(Note that any consistent reported cases will be counted by the
<code>hits_*</code> columns if both <code>include_reported</code> and <code>include_consistent</code> are
set to <code>TRUE</code>.)</p></li>
<li><p><code>diff_x</code> reports the absolute difference between <code>x</code> and the next
consistent dispersed value (in dispersion steps, not the actual numeric
difference). <code>diff_x_up</code> and <code>diff_x_down</code> report the difference to the
next higher or lower consistent value, respectively.</p></li>
<li><p><code>diff_sd</code>, <code>diff_sd_up</code>, and <code>diff_sd_down</code> do the same for <code>sd</code>.</p></li>
<li><p>Likewise with <code>diff_n</code>, <code>diff_n_up</code>, and <code>diff_n_down</code>.</p></li>
</ul><p>Call <code><a href="audit.html">audit()</a></code> following <code><a href="audit-special.html">audit_seq()</a></code> to summarize results even
further. It's mostly self-explaining, but <code>na_count</code> and <code>na_rate</code> are the
number and rate of times that a difference could not be computed because of
a lack of corresponding hits within the <code>dispersion</code> range.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># `grimmer_map_seq()` can take any input</span></span></span>
<span class="r-in"><span><span class="co"># that `grimmer_map()` can take:</span></span></span>
<span class="r-in"><span><span class="va">pigs5</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 12 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    x     sd        n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 7.22  5.30     38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 4.74  6.55     31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 5.23  2.55     35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 2.57  2.57     30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 6.77  2.18     33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 2.68  2.59     34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 7.01  6.68     35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 7.38  3.65     32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 3.14  5.32     33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 6.89  4.18     37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> 5.00  2.18     31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> 0.24  6.43     34</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># All the results:</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">grimmer_map_seq</span><span class="op">(</span><span class="va">pigs5</span>, include_consistent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 360 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    x     sd        n consistency reason            diff_var  case var  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 7.17  5.30     38 FALSE       GRIM inconsistent       -<span style="color: #BB0000;">5</span>     1 x    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 7.18  5.30     38 TRUE        Passed all              -<span style="color: #BB0000;">4</span>     1 x    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 7.19  5.30     38 FALSE       GRIM inconsistent       -<span style="color: #BB0000;">3</span>     1 x    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 7.20  5.30     38 FALSE       GRIM inconsistent       -<span style="color: #BB0000;">2</span>     1 x    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 7.21  5.30     38 TRUE        Passed all              -<span style="color: #BB0000;">1</span>     1 x    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 7.23  5.30     38 FALSE       GRIM inconsistent        1     1 x    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 7.24  5.30     38 TRUE        Passed all               2     1 x    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 7.25  5.30     38 FALSE       GRIM inconsistent        3     1 x    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 7.26  5.30     38 TRUE        Passed all               4     1 x    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 7.27  5.30     38 FALSE       GRIM inconsistent        5     1 x    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 350 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Case-wise summaries with `audit_seq()`</span></span></span>
<span class="r-in"><span><span class="co"># can be more important than the raw results:</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="audit-special.html">audit_seq</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 12 × 17</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    x     sd        n consistency hits_total hits_x hits_sd hits_n diff_x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 7.22  5.30     38 FALSE                8      4       0      4      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 4.74  6.55     31 TRUE                15      2      10      3      3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 5.23  2.55     35 FALSE               15      2      10      3      3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 2.57  2.57     30 TRUE                11      2       7      2      3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 6.77  2.18     33 FALSE                5      3       0      2      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 2.68  2.59     34 TRUE                13      2       8      3      3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 7.01  6.68     35 FALSE                4      4       0      0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 7.38  3.65     32 TRUE                16      3      10      3      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 3.14  5.32     33 FALSE                9      4       0      5      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 6.89  4.18     37 TRUE                16      3      10      3      3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> 5.00  2.18     31 TRUE                15      2       6      7      3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> 0.24  6.43     34 TRUE                17      3      10      4      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 8 more variables: diff_x_up &lt;int&gt;, diff_x_down &lt;int&gt;, diff_sd &lt;int&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   diff_sd_up &lt;int&gt;, diff_sd_down &lt;int&gt;, diff_n &lt;int&gt;, diff_n_up &lt;int&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   diff_n_down &lt;int&gt;</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lukas Jung.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

