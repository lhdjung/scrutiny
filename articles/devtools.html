<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Developer tools • scrutiny</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Developer tools">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scrutiny</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Consistency tests</h6></li>
    <li><a class="dropdown-item" href="../articles/grim.html">GRIM</a></li>
    <li><a class="dropdown-item" href="../articles/grimmer.html">GRIMMER</a></li>
    <li><a class="dropdown-item" href="../articles/debit.html">DEBIT</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Plausibility checks</h6></li>
    <li><a class="dropdown-item" href="../articles/duplicates.html">Duplication analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Quick guides</h6></li>
    <li><a class="dropdown-item" href="../articles/rounding-options.html">Rounding options</a></li>
    <li><a class="dropdown-item" href="../articles/consistency-tests-simple.html">Implementing your consistency test</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developer tools</h6></li>
    <li><a class="dropdown-item" href="../articles/rounding-in-depth.html">Rounding in depth</a></li>
    <li><a class="dropdown-item" href="../articles/consistency-tests-in-depth.html">Consistency tests in depth</a></li>
    <li><a class="dropdown-item" href="../articles/devtools.html">Developer tools</a></li>
    <li><a class="dropdown-item" href="../articles/wrangling.html">Data wrangling</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Other</h6></li>
    <li><a class="dropdown-item" href="../articles/related.html">Related software</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lhdjung/scrutiny/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Developer tools</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lhdjung/scrutiny/blob/main/vignettes/devtools.Rmd" class="external-link"><code>vignettes/devtools.Rmd</code></a></small>
      <div class="d-none name"><code>devtools.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lhdjung.github.io/scrutiny/">scrutiny</a></span><span class="op">)</span></span></code></pre></div>
<p>The implementation of error detection techniques in scrutiny rests on
a foundation of specialized helper functions. Some of these are exported
because they might be helpful in error detection more broadly, or
perhaps even in other contexts.</p>
<p>This vignette provides an overview of scrutiny’s miscellaneous
infrastructure for implementing error detection techniques. For more
specific articles, see <code><a href="../articles/rounding-in-depth.html">vignette("rounding-in-depth")</a></code> or
<code><a href="../articles/consistency-tests-simple.html">vignette("consistency-tests-simple")</a></code>.</p>
<div class="section level3">
<h3 id="count-decimal-places">Count decimal places<a class="anchor" aria-label="anchor" href="#count-decimal-places"></a>
</h3>
<p>Large parts of the package ultimately rest on either of two functions
that simply count decimal places. These are digits after a number’s
decimal point or some other separator. Both functions also take
strings.</p>
<p><code><a href="../reference/decimal_places.html">decimal_places()</a></code> is vectorized:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/decimal_places.html">decimal_places</a></span><span class="op">(</span><span class="st">"2.80"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span></span>
<span><span class="fu"><a href="../reference/decimal_places.html">decimal_places</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">55.1</span>, <span class="fl">6.493</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 3 0</span></span>
<span></span>
<span><span class="va">vec1</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">Sepal.Length</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vec1</span></span>
<span><span class="co">#&gt;  [1] 5.1 4.9 4.7 4.6 5.0 5.4 4.6 5.0 4.4 4.9</span></span>
<span></span>
<span><span class="va">vec1</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/decimal_places.html">decimal_places</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 1 1 1 1 0 1 1 0 1 1</span></span></code></pre></div>
<p>Using strings (that are coercible to numeric) is recommended in an
error detection context because trailing zeros can be crucial here.
Numeric values drop trailing zeros, whereas strings preserve them:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/decimal_places.html">decimal_places</a></span><span class="op">(</span><span class="fl">7.200</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span></span>
<span><span class="fu"><a href="../reference/decimal_places.html">decimal_places</a></span><span class="op">(</span><span class="st">"7.200"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3</span></span></code></pre></div>
<p><code><a href="../reference/decimal_places.html">decimal_places_scalar()</a></code> is faster than
<code><a href="../reference/decimal_places.html">decimal_places()</a></code> but only takes a single number or string.
This makes it suitable as a helper within other single-case
functions.</p>
</div>
<div class="section level3">
<h3 id="restore-trailing-zeros">Restore trailing zeros<a class="anchor" aria-label="anchor" href="#restore-trailing-zeros"></a>
</h3>
<p>When dealing with numbers that used to have trailing zeros but lost
them from being registered as numeric, call <code><a href="../reference/restore_zeros.html">restore_zeros()</a></code>
to format them correctly. This can be relevant within functions that
create vectors where trailing zeros matter, such as the
<code>seq_*()</code> functions presented in the next section.</p>
<p>Suppose all of the following numbers originally had one decimal
place, but some no longer do:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vec2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6.9</span>, <span class="fl">5</span>, <span class="fl">4.2</span>, <span class="fl">4.8</span>, <span class="fl">7</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vec2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/decimal_places.html">decimal_places</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0 1 0 1 1 0 0</span></span></code></pre></div>
<p>Now, get them back with <code><a href="../reference/restore_zeros.html">restore_zeros()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vec2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/restore_zeros.html">restore_zeros</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "4.0" "6.9" "5.0" "4.2" "4.8" "7.0" "4.0"</span></span>
<span></span>
<span><span class="va">vec2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/restore_zeros.html">restore_zeros</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/decimal_places.html">decimal_places</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 1 1 1 1 1 1</span></span></code></pre></div>
<p>This uses the default of going by the longest mantissa and padding
the other strings with decimal zeros until they have that many decimal
places. However, this is just a heuristic: The longest mantissa might
itself have lost decimal places. Specify the <code>width</code> argument
to explicitly state the desired mantissa length:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vec2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/restore_zeros.html">restore_zeros</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "4.00" "6.90" "5.00" "4.20" "4.80" "7.00" "4.00"</span></span>
<span></span>
<span><span class="va">vec2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/restore_zeros.html">restore_zeros</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/decimal_places.html">decimal_places</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2 2 2 2 2 2 2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="sequence-generation">Sequence generation<a class="anchor" aria-label="anchor" href="#sequence-generation"></a>
</h3>
<div class="section level4">
<h4 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h4>
<p><code><a href="https://rdrr.io/r/base/seq.html" class="external-link">base::seq()</a></code> offers a flexible way to generate sequences,
but it is not cut out for working with decimal numbers. The
<code>by</code> argument only allows for manual specifications of the
step size, i.e., the difference between two consecutive output values.
In an error detection context, there is also the problem of trailing
zeros in numeric values.</p>
<p>Use scrutiny’s <code>seq_*()</code> functions to automatically
determine step size from the input numbers and, by default, to supply
missing trailing zeros via <code><a href="../reference/restore_zeros.html">restore_zeros()</a></code>. Output will
then naturally be string.</p>
<p>Why are there multiple such functions? The first two disentangle the
two different ways in which <code><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq()</a></code> can be used. A third
function adds a way of generating sequences not directly covered by
<code><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq()</a></code>.</p>
<ul>
<li><p><code><a href="../reference/seq-decimal.html">seq_endpoint()</a></code> takes two main arguments,
<code>from</code> and <code>to</code>. It creates a sequence between the
two, inferring step size from the greater number of decimal places among
them. This corresponds to a <code><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq()</a></code> call in which
<code>to</code> was specified.</p></li>
<li><p><code><a href="../reference/seq-decimal.html">seq_distance()</a></code> takes a <code>from</code> argument,
uses it to infer the step size, and creates a sequence of a length
specified by the <code>length_out</code> argument (default is
<code>10</code>). This corresponds to a <code><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq()</a></code> call in which
<code>length.out</code> was specified.</p></li>
<li><p>Finally, <code><a href="../reference/seq_disperse.html">seq_disperse()</a></code> creates a sequence centered
around <code>from</code>.</p></li>
</ul>
<p>Each of these functions has a <code>*_df()</code> variant that embeds
the sequence as a tibble column.</p>
</div>
<div class="section level4">
<h4 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h4>
<p>The <code>seq_*()</code> functions have some more features, such as
offsets and direction reversal, but I’ll focus on the basics here.</p>
<p>Call <code><a href="../reference/seq-decimal.html">seq_endpoint()</a></code> to bridge two numbers at the correct
decimal level:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/seq-decimal.html">seq_endpoint</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">4.1</span>, to <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "4.1" "4.2" "4.3" "4.4" "4.5" "4.6" "4.7" "4.8" "4.9" "5.0" "5.1" "5.2"</span></span>
<span><span class="co">#&gt; [13] "5.3" "5.4" "5.5" "5.6" "5.7" "5.8" "5.9" "6.0"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/seq-decimal.html">seq_endpoint</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">4.1</span>, to <span class="op">=</span> <span class="fl">4.15</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "4.10" "4.11" "4.12" "4.13" "4.14" "4.15"</span></span></code></pre></div>
<p>Call <code><a href="../reference/seq-decimal.html">seq_distance()</a></code> to get a sequence of desired
length:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/seq-decimal.html">seq_distance</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">4.1</span>, length_out <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "4.1" "4.2" "4.3"</span></span>
<span></span>
<span><span class="co"># Default for `length_out` is `10`:</span></span>
<span><span class="fu"><a href="../reference/seq-decimal.html">seq_distance</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">4.1</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "4.1" "4.2" "4.3" "4.4" "4.5" "4.6" "4.7" "4.8" "4.9" "5.0"</span></span></code></pre></div>
<p>Finally, call <code><a href="../reference/seq_disperse.html">seq_disperse()</a></code> to construct a sequence
around <code>from</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/seq_disperse.html">seq_disperse</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">4.1</span>, dispersion <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "3.8" "3.9" "4.0" "4.1" "4.2" "4.3" "4.4"</span></span>
<span></span>
<span><span class="co"># Default for `dispersion` if `1:5`:</span></span>
<span><span class="fu"><a href="../reference/seq_disperse.html">seq_disperse</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">4.1</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "3.6" "3.7" "3.8" "3.9" "4.0" "4.1" "4.2" "4.3" "4.4" "4.5" "4.6"</span></span></code></pre></div>
<p><code><a href="../reference/seq_disperse.html">seq_disperse()</a></code> is a hybrid between the two
<code><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq()</a></code> wrappers explained above and the
<code>disperse*()</code> functions introduced next.</p>
</div>
</div>
<div class="section level3">
<h3 id="sequence-testing">Sequence testing<a class="anchor" aria-label="anchor" href="#sequence-testing"></a>
</h3>
<div class="section level4">
<h4 id="general-points">General points<a class="anchor" aria-label="anchor" href="#general-points"></a>
</h4>
<p>Four predicate functions test whether a vector <code>x</code>
represents particular kinds of sequences. These testing functions can be
used as helpers, but they are also analytic tools in their own
right.</p>
<p><code><a href="../reference/seq-predicates.html">is_seq_linear()</a></code> returns <code>TRUE</code> if the
difference between all neighboring values is the same:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_linear</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">8</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_linear</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span><span class="op">:</span><span class="fl">15</span>, <span class="fl">16</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_linear</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span><span class="op">:</span><span class="fl">15</span>, <span class="fl">17</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p><code><a href="../reference/seq-predicates.html">is_seq_ascending()</a></code> tests whether that difference is
always positive…</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_ascending</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">8</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_ascending</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span></span>
<span><span class="co"># Default also tests for linearity:</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_ascending</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span><span class="op">:</span><span class="fl">15</span>, <span class="fl">17</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_ascending</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span><span class="op">:</span><span class="fl">15</span>, <span class="fl">17</span><span class="op">)</span>, test_linear <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>…whereas <code><a href="../reference/seq-predicates.html">is_seq_descending()</a></code> tests whether it is always
negative:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_descending</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">8</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_descending</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># Default also tests for linearity:</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_descending</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span><span class="op">:</span><span class="fl">8</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_descending</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span><span class="op">:</span><span class="fl">8</span>, <span class="fl">2</span><span class="op">)</span>, test_linear <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p><code><a href="../reference/seq-predicates.html">is_seq_dispersed()</a></code> tests whether the vector is grouped
around its <code>from</code> argument:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_dispersed</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">7</span>, from <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span></span>
<span><span class="co"># Direction doesn't matter here:</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_dispersed</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">7</span>, from <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_dispersed</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">7</span><span class="op">:</span><span class="fl">3</span>, from <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># Dispersed from `50`, but not linear:</span></span>
<span><span class="va">x_nonlinear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">49</span>, <span class="fl">42</span>, <span class="fl">47</span>, <span class="fl">44</span>, <span class="fl">50</span>, <span class="fl">56</span>, <span class="fl">53</span>, <span class="fl">58</span>, <span class="fl">51</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default also tests for linearity:</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_dispersed</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_nonlinear</span>, from <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_dispersed</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_nonlinear</span>, from <span class="op">=</span> <span class="fl">50</span>, test_linear <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="na-handling">
<code>NA</code> handling<a class="anchor" aria-label="anchor" href="#na-handling"></a>
</h4>
<p>All the <code>is_seq_*()</code> functions take special care with
missing values. If one or more elements of <code>x</code> are
<code>NA</code>, this doesn’t necessarily mean that it’s unknown whether
or not <code>x</code> might possibly represent the kind of sequence in
question.</p>
<p>In these examples, it is genuinely unclear whether <code>x</code> is
linear:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_linear</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="cn">NA</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_linear</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] NA</span></span></code></pre></div>
<p>Linearity thus depends on the unknown, missing value behind
<code>NA</code>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_linear</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_linear</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">7</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_linear</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_linear</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">17</span>, <span class="fl">29</span>, <span class="fl">32</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p>Sometimes, however, <code>x</code> cannot possibly represent the
tested kind of sequence, independently of the hypothetical numbers
substituted for <code>NA</code> elements. In such cases, scrutiny’s
<code>is_seq_*()</code> functions will always return
<code>FALSE</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_linear</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="cn">NA</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_linear</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p>This is very much in the spirit of consistency testing. Even if
certain data are unknown, it still makes sense to check whether or not
<em>any</em> data could possibly fill in the gaps. The
<code>is_seq_*()</code> functions effectively ask: Are the numbers left
and right of the <code>NA</code>s consistent with each other, given
their index positions?</p>
<p>It is worth emphasizing that this behavior is not exotic, or specific
to scrutiny. It simply asserts the fundamental ideas of <code>NA</code>
propagation in R. For example,
<code>is_seq_ascending(x = c(1, 2, NA, 1))</code> is <code>FALSE</code>
for the same reason that <code>NA &amp; FALSE</code> is
<code>FALSE</code>: The outcome is the same for all possible values of
<code>NA</code> <span class="citation">(Wickham 2019,
ch. 3.2.3)</span>.</p>
<p>Leading and trailing <code>NA</code>s are mostly ignored when
determining whether <code>x</code> <em>might</em> be the kind of
sequence in question:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_linear</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_linear</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="cn">NA</span>, <span class="fl">4</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] NA</span></span></code></pre></div>
<p>The only exception, <code><a href="../reference/seq-predicates.html">is_seq_dispersed()</a></code>, is particularly
sensitive to <code>NA</code> values:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># `TRUE` because `x` is symmetrically dispersed</span></span>
<span><span class="co"># from 5 and contains no `NA` values:</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_dispersed</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>, from <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># `NA` because it might be dispersed from 5,</span></span>
<span><span class="co"># depending on the values hidden behind the `NA`s:</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_dispersed</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">7</span>, <span class="cn">NA</span><span class="op">)</span>, from <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_dispersed</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">7</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, from <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span></span>
<span><span class="co"># `FALSE` because it's not symmetrically dispersed</span></span>
<span><span class="co"># around 5, no matter what the `NA`s stand in for:</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_dispersed</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>, from <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_dispersed</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">7</span>, <span class="cn">NA</span><span class="op">)</span>, from <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_dispersed</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">7</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, from <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="fu"><a href="../reference/seq-predicates.html">is_seq_dispersed</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>, from <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="disperse-from-around-half-with-disperse_total">Disperse from (around) half with <code>disperse_total()</code><a class="anchor" aria-label="anchor" href="#disperse-from-around-half-with-disperse_total"></a>
</h3>
<p>Briefly, <code><a href="../reference/disperse.html">disperse_total()</a></code> checks if an input total is
even or odd, cuts it in half, and creates “dispersed” group sizes going
out from there, with each pair of group sizes adding up to the input
total. This works naturally with even totals. For odd totals, it starts
with the two integers closest to half.</p>
<p>The function internally calls either of <code><a href="../reference/disperse.html">disperse()</a></code> and
<code><a href="../reference/disperse.html">disperse2()</a></code>, but I recommend simply using the higher-level
<code><a href="../reference/disperse.html">disperse_total()</a></code>. Here are two basic examples:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># With an even total...</span></span>
<span><span class="fu"><a href="../reference/disperse.html">disperse_total</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 2</span></span></span>
<span><span class="co">#&gt;        n n_change</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>    35        0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>    35        0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>    34       -<span style="color: #BB0000;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>    36        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>    33       -<span style="color: #BB0000;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>    37        2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>    32       -<span style="color: #BB0000;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>    38        3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>    31       -<span style="color: #BB0000;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    39        4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>    30       -<span style="color: #BB0000;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>    40        5</span></span>
<span></span>
<span><span class="co"># ...and with an odd total:</span></span>
<span><span class="fu"><a href="../reference/disperse.html">disperse_total</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">83</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 2</span></span></span>
<span><span class="co">#&gt;        n n_change</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>    41        0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>    42        0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>    40       -<span style="color: #BB0000;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>    43        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>    39       -<span style="color: #BB0000;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>    44        2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>    38       -<span style="color: #BB0000;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>    45        3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>    37       -<span style="color: #BB0000;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    46        4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>    36       -<span style="color: #BB0000;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>    47        5</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="test-for-subsets-supersets-and-equal-sets">Test for subsets, supersets, and equal sets<a class="anchor" aria-label="anchor" href="#test-for-subsets-supersets-and-equal-sets"></a>
</h3>
<p>Starting with <code><a href="../reference/subset-superset.html">is_subset_of()</a></code>, scrutiny features a
distinctive family of predicate functions that test whether one vector
<code>x</code> is a subset of another vector <code>y</code>, whether
<code>x</code> is a superset of <code>y</code> (i.e. the reverse of a
subset), or whether <code>x</code> and <code>y</code> are equal
sets.</p>
<p>As a teaser: These functions are divided into three subgroups based
on the way the second vector, <code>y</code>, is constituted. For
example, you might test if <code>x</code> is a subset of multiple other
vectors taken together, or a superset of a vector <code>y</code> that
consists of multiple values entered along with <code>x</code>.</p>
<p>Functions from this family are not currently used as helpers inside
other scrutiny functions, but that may well change. Use elsewhere is
also conceivable.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-wickham2019" class="csl-entry">
Wickham, Hadley. 2019. <em>Advanced r</em>. Second edition. Boca Raton:
CRC Press/Taylor; Francis Group.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lukas Jung.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
